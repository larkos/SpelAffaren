@using System.Diagnostics;
@model SpelAffaren.Models.TheShopModel


@{
   ViewBag.Title = "TheShop";
}
<script type="text/javascript">
    function removefromcart(item) {
        //alert(item)
        var data = document.getElementById(item);
        //alert(data.value)
        $.ajax({
            url: "/Home/RemoveProdukt",
            type: "POST",
            data: { id: data.value },
            success: function (result) {
                
                $('#CartPlacer').html(result);
            }
        })

        
    }

    function Pay() {
        $.ajax({
            url: "/Home/Pay",
            type: "POST",
            success: function (result) {
                $('#CartPlacer').html(result);

                
                //Get the original shoppingcart

                setTimeout(function () {
                    $.ajax({
                        url: "/Home/ShoppingCart",
                        type: "POST",
                        success: function (result) {
                            $('#CartPlacer').html(result);

                        }
                    }
       )
                }, 3000);
               




            }
        }
    )
    }
    
    function PutInComment() {
        //alert(item)
        var data = document.getElementById("Comment");
        //alert(data.value)
        $.ajax({
            url: "/Home/CommentKV",
            type: "POST",
            data: { OrderComment: data.value },
            success: function (result) {
            }
            }
        )

    }

    function AddToCart(item) {
        //alert(item)
        //var data = document.getElementById(item);
        //alert(data.value)
        $.ajax({
            url: "/Home/AddProdukt",
            type: "POST",
            data: { sp: item },
            success: function (result) {
                
                $('#CartPlacer').html(result);
            }
        })

    }

    function UpdateList() {
        var antalitem = document.getElementsByClassName("itemantal");
        var produktid = document.getElementsByClassName("updatefunc");

        var produkt = [];

        var json = "";
        //alert(antalitem + " " + produktid);
        for (i = 0; i < produktid.length; i++) {
            var item = {
                "antal": antalitem[i].value,
                "id": produktid[i].value
            }
            produkt.push(item)
        };
        //alert(antalitem + " " + produktid);
        //for (i = 0; i < produkt.length; i++) {
        //    alert(produkt[i].id + " " + produkt[i].antal);
        //};
        produkt = JSON.stringify({ 'produkt': produkt });

        $.ajax({
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            type: 'POST',
            url: '/Home/UpdateCart',
            data: produkt,
            success: function (result) {
                $('#CartPlacer').html(result);
            },
            //failure: function (response) {
            //    $('#result').html(response);
            //}
        });
    }
</script>
<div class="row">
   <h2>TheShop</h2> 
      <div id="CartPlacer">
         @Html.Partial("ShoppingCart", Model.Cart)
      </div>
      <h3>Här är våra varor. Va Coolt!</h3>
      <div>
         @Html.Partial("~/Views/Shared/Products.cshtml", Model)
      </div>
</div>